#!/bin/sh

prefix="split-logs"
inputfile=$(mktemp -t $prefix)

# merge all logs
while test -n "$*"; do
	test -f "$1" && cat "$1" >> $inputfile
	shift
done

pids=$(cut -d' ' -f3 $inputfile | grep -E '[0-9]+' | sort -n | uniq)
for pid in $pids; do
	grep " $pid " $inputfile | sort -nk1 -t' ' >$inputfile.$pid
done

paste -d'|' $(ls $inputfile.*) | column -t -s'|'

rm $inputfile
rm $inputfile.*
